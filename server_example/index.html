<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
    
    <script>
        $(document).ready(function () {
            $("#chatbot_submit").click(function (e) { 
                e.preventDefault();
                name = $("#chatbot_n").val();
                phrase = $("#chatbot_p").val();
                ajaxSendMessage(name, phrase)
            });

            $(document).on('click', '.resp_act_btn', function (e) {
                console.log(e.currentTarget.value)
                name = $("#chatbot_n").val();
                ajaxSendMessage(name, e.currentTarget.value)
            });

        });

        function ajaxSendMessage(name, phrase) {
            $.ajax({
                    type: "post",
                    url: "http://127.0.0.1:12160/chatbot",
                    data: {
                        "name": name,
                        "phrase" : phrase
                    },
                    success: function (response) {
                        let output = JSON.parse(response)
                        let validKeywords = output.validKeywords
                        let invalidKeywords = output.invalidKeywords
                        var body = output.response

                        validKeywords.forEach(keyword => {
                            body = body.replace(keyword, `<input type="button" value="${keyword}" class="resp_act_btn">`)
                        });        
                        $("#chatbot_response").html(body + "<br>" + $("#chatbot_response").html());
                        $("#chatbot_p").val(""); 
                    }
                });
        }
    </script>
</head>
<body>
    <form action="http://localhost:12160/chatbot" method="post">
    <fieldset>
        <legend>ChatBot test client</legend>
        Name : <input type="text" name="name" id="chatbot_n"><br>
        Chat : <input type="text" name="phrase" id="chatbot_p"><br>
        <input type="submit" value="submit!", id="chatbot_submit">
    </fieldset>
    </form>
    <div id="chatbot_response">
        ChatBot response area <br>
    </div>
</body>
</html>